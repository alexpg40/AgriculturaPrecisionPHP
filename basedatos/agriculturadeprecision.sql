-- phpMyAdmin SQL Dump
-- version 5.1.1
-- https://www.phpmyadmin.net/
--
-- Servidor: 127.0.0.1
-- Tiempo de generación: 06-01-2022 a las 14:23:40
-- Versión del servidor: 10.4.22-MariaDB
-- Versión de PHP: 8.1.1

SET SQL_MODE = "NO_AUTO_VALUE_ON_ZERO";
START TRANSACTION;
SET time_zone = "+00:00";


/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8mb4 */;

--
-- Base de datos: `agriculturadeprecision`
--

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `dron`
--

CREATE TABLE `dron` (
  `idDron` int(11) NOT NULL,
  `marca` varchar(20) NOT NULL,
  `idPiloto` int(11) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `dron`
--

INSERT INTO `dron` (`idDron`, `marca`, `idPiloto`) VALUES
(1, 'DJI T30', 4),
(2, 'DJI Agras T16', 4);

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `parcela`
--

CREATE TABLE `parcela` (
  `idParcela` int(11) NOT NULL,
  `idAgricultor` int(11) NOT NULL,
  `area` double NOT NULL,
  `municipio` int(11) NOT NULL,
  `provincia` int(11) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `parcela`
--

INSERT INTO `parcela` (`idParcela`, `idAgricultor`, `area`, `municipio`, `provincia`) VALUES
(44, 2, 16953.968600639942, 35, 39),
(45, 2, 16587.393946652588, 35, 39);

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `punto`
--

CREATE TABLE `punto` (
  `idPunto` int(11) NOT NULL,
  `idParcela` int(11) NOT NULL,
  `Lon` double NOT NULL,
  `Lat` double NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `punto`
--

INSERT INTO `punto` (`idPunto`, `idParcela`, `Lon`, `Lat`) VALUES
(1021, 44, 43.41287643799939, -3.403748759478257),
(1022, 44, 43.41290148145117, -3.403823945154187),
(1023, 44, 43.412901640707354, -3.403824423760886),
(1024, 44, 43.41291248353794, -3.403856974883794),
(1025, 44, 43.41295263788567, -3.403975131227084),
(1026, 44, 43.413089526107285, -3.404377932828094),
(1027, 44, 43.41311014726669, -3.404431160430977),
(1028, 44, 43.41313060078803, -3.404477347234777),
(1029, 44, 43.41313847307196, -3.4044917045975747),
(1030, 44, 43.41315105347118, -3.404514648382494),
(1031, 44, 43.41316268252433, -3.4045299998390677),
(1032, 44, 43.413172261363854, -3.404542645617136),
(1033, 44, 43.41318776453288, -3.404555793471235),
(1034, 44, 43.41319874985582, -3.404565109957165),
(1035, 44, 43.413217973751905, -3.4045797414082135),
(1036, 44, 43.41323663857499, -3.4045939462203654),
(1037, 44, 43.41325799147459, -3.4046033171886694),
(1038, 44, 43.41325833764723, -3.404603469739316),
(1039, 44, 43.41330311042386, -3.4046231177597117),
(1040, 44, 43.413532953119, -3.404686178173791),
(1041, 44, 43.413533844953555, -3.404686422925378),
(1042, 44, 43.41365173056135, -3.404718766177074),
(1043, 44, 43.41371308525803, -3.404477359807632),
(1044, 44, 43.413724148532694, -3.4044329340417945),
(1045, 44, 43.4137472842632, -3.404443579897647),
(1046, 44, 43.41375935420449, -3.4044082074259645),
(1047, 44, 43.41376538917514, -3.4043937058944227),
(1048, 44, 43.41377234615517, -3.404392365628026),
(1049, 44, 43.413842086946495, -3.404417848291567),
(1050, 44, 43.41385005059316, -3.4044201122437485),
(1051, 44, 43.413854827440076, -3.404371579345112),
(1052, 44, 43.41384577414592, -3.404319273751632),
(1053, 44, 43.413874357275624, -3.4042908590981877),
(1054, 44, 43.41388542055029, -3.404249115541525),
(1055, 44, 43.41390754877598, -3.404169736399188),
(1056, 44, 43.41393688460063, -3.404025479646055),
(1057, 44, 43.41395368361198, -3.4039911993364216),
(1058, 44, 43.41395392333442, -3.4039896294058636),
(1059, 44, 43.41395825258766, -3.403960877799891),
(1060, 44, 43.413974379370316, -3.4037786711396976),
(1061, 44, 43.41401168554717, -3.4033344905948333),
(1062, 44, 43.41402912912692, -3.403134752344921),
(1063, 44, 43.41404941165742, -3.402948125906922),
(1064, 44, 43.41406376399107, -3.402808023225249),
(1065, 44, 43.41389998159334, -3.4027425815123364),
(1066, 44, 43.41391233987212, -3.402612010731519),
(1067, 44, 43.41391240022182, -3.402611375383221),
(1068, 44, 43.41392034710469, -3.402527410501386),
(1069, 44, 43.41386553867478, -3.4025333591384204),
(1070, 44, 43.41382480597569, -3.4025588443165327),
(1071, 44, 43.413822201718226, -3.402560473758607),
(1072, 44, 43.413813559975544, -3.402565880924665),
(1073, 44, 43.413807252593024, -3.402566595062858),
(1074, 44, 43.41380437843826, -3.40256692028072),
(1075, 44, 43.413803671005574, -3.4025669999088053),
(1076, 44, 43.41373644059443, -3.4025745981044824),
(1077, 44, 43.41370600841677, -3.402570879892014),
(1078, 44, 43.413666448346014, -3.402566046886357),
(1079, 44, 43.41363430290725, -3.4025517792099285),
(1080, 44, 43.41363387794472, -3.4025515906170956),
(1081, 44, 43.413607521048625, -3.4025398928323325),
(1082, 44, 43.41355655572155, -3.402492616381056),
(1083, 44, 43.413532078886455, -3.4024746774308197),
(1084, 44, 43.41350416630903, -3.4024653726795537),
(1085, 44, 43.41322470106779, -3.4024836402004146),
(1086, 44, 43.41321061779324, -3.4023875793933915),
(1087, 44, 43.413201196533514, -3.402395482690363),
(1088, 44, 43.413188237272244, -3.4024063548576153),
(1089, 44, 43.41317001417548, -3.402436477743028),
(1090, 44, 43.41316960849133, -3.4024371474571313),
(1091, 44, 43.41316166579943, -3.402450277709232),
(1092, 44, 43.41314238742097, -3.4024998155981194),
(1093, 44, 43.41312813902292, -3.402558155324051),
(1094, 44, 43.413132163174865, -3.4026403851518263),
(1095, 44, 43.41315538356262, -3.4027263876744445),
(1096, 44, 43.41317725530205, -3.4027867164261174),
(1097, 44, 43.41317943208244, -3.402792013789237),
(1098, 44, 43.4131812635284, -3.402796469609229),
(1099, 44, 43.413182541768705, -3.4027995801336814),
(1100, 44, 43.41318426508809, -3.402803771923707),
(1101, 44, 43.41318492474391, -3.4028053762200696),
(1102, 44, 43.41320458952812, -3.4028532109061302),
(1103, 44, 43.41319884457135, -3.4028741195648387),
(1104, 44, 43.413198674418695, -3.40287473898752),
(1105, 44, 43.41318438997846, -3.4029267227158977),
(1106, 44, 43.41312827313338, -3.403073385075383),
(1107, 44, 43.41312725808484, -3.403076038786086),
(1108, 44, 43.41312472674994, -3.4030826546226534),
(1109, 44, 43.41312344850963, -3.4030859948112666),
(1110, 44, 43.41307492147832, -3.4032189242597775),
(1111, 44, 43.41303319217091, -3.4033433469142524),
(1112, 44, 43.41303211761083, -3.4033465513160257),
(1113, 44, 43.41302949239862, -3.4033543800140547),
(1114, 44, 43.41299546186971, -3.403469885999405),
(1115, 44, 43.41297987236707, -3.403556557397935),
(1116, 44, 43.412970805661864, -3.4035950051900747),
(1117, 44, 43.41297049469324, -3.4035963245017125),
(1118, 44, 43.41296991550369, -3.4035987803994883),
(1119, 44, 43.41296938660558, -3.40360102255872),
(1120, 44, 43.41296242962553, -3.4036305033903123),
(1121, 44, 43.4129598312354, -3.4036354118331023),
(1122, 44, 43.412934526268195, -3.403683212153358),
(1123, 44, 43.412909603515835, -3.403711334278365),
(1124, 44, 43.41287643799939, -3.403748759478257),
(1125, 45, 43.4133334847664, -3.4085583921966487),
(1126, 45, 43.413334514902346, -3.4085592957658646),
(1127, 45, 43.41335023264811, -3.4085716297371165),
(1128, 45, 43.413427471052245, -3.4086433017190285),
(1129, 45, 43.41347536944078, -3.4086840721366745),
(1130, 45, 43.41348635392554, -3.408692063443635),
(1131, 45, 43.41350745033889, -3.4087074123856373),
(1132, 45, 43.41353182910573, -3.4087251484938057),
(1133, 45, 43.413590055675954, -3.4087675097967693),
(1134, 45, 43.41364047869388, -3.4088041940363762),
(1135, 45, 43.41378869002914, -3.408919071378951),
(1136, 45, 43.41384930879469, -3.4089683837946283),
(1137, 45, 43.41388649343395, -3.408993211831493),
(1138, 45, 43.41408110866434, -3.409123154807726),
(1139, 45, 43.41409356584957, -3.409117671366344),
(1140, 45, 43.414113990872444, -3.409130215723379),
(1141, 45, 43.414138854113304, -3.409145486713677),
(1142, 45, 43.414199564241585, -3.4091827744503482),
(1143, 45, 43.41421524510697, -3.409222887726748),
(1144, 45, 43.41422237056328, -3.409190944291857),
(1145, 45, 43.414222595198304, -3.409189938463416),
(1146, 45, 43.41422384577833, -3.409184335999002),
(1147, 45, 43.41435550872121, -3.4092445080090763),
(1148, 45, 43.4144261547581, -3.409274389495664),
(1149, 45, 43.414679738357194, -3.409381648525992),
(1150, 45, 43.41474067060594, -3.409407658411274),
(1151, 45, 43.414763393946785, -3.4094173587883927),
(1152, 45, 43.4148750484474, -3.4094841390913206),
(1153, 45, 43.414982980544586, -3.4095486931606347),
(1154, 45, 43.414985657724635, -3.4089730818516366),
(1155, 45, 43.41496953094196, -3.408923935397651),
(1156, 45, 43.41495024166705, -3.4088857449299534),
(1157, 45, 43.41470046931954, -3.408391226862593),
(1158, 45, 43.414662258735284, -3.408273990014135),
(1159, 45, 43.41464011123121, -3.4081708255437513),
(1160, 45, 43.41464824670691, -3.4081103551379055),
(1161, 45, 43.4146637540669, -3.4080530220786045),
(1162, 45, 43.41466366018958, -3.4080479510268837),
(1163, 45, 43.41466348836055, -3.4080386102334326),
(1164, 45, 43.414663226006965, -3.408024361835382),
(1165, 45, 43.41466282367559, -3.4080108954689434),
(1166, 45, 43.414641086046615, -3.407970852600536),
(1167, 45, 43.41463219284681, -3.4079648637303626),
(1168, 45, 43.414610704160374, -3.4079559495758094),
(1169, 45, 43.414580427047945, -3.407962168948333),
(1170, 45, 43.41455354795924, -3.4079687805939485),
(1171, 45, 43.41454700169246, -3.4079681142326064),
(1172, 45, 43.41454190298047, -3.4079675643797254),
(1173, 45, 43.41453925429891, -3.407968414304758),
(1174, 45, 43.41453301816257, -3.4079704142269738),
(1175, 45, 43.41451489229589, -3.4079617490149587),
(1176, 45, 43.41450250635685, -3.4079558280382054),
(1177, 45, 43.41446369479007, -3.407903857720873),
(1178, 45, 43.41443056363944, -3.407855427919652),
(1179, 45, 43.41421682928677, -3.4075429974894527),
(1180, 45, 43.41419252008974, -3.4075097196554975),
(1181, 45, 43.41418169150839, -3.4074948828478093),
(1182, 45, 43.414168294711764, -3.4074765256405795),
(1183, 45, 43.414149525114865, -3.4074537335681163),
(1184, 45, 43.41413082424958, -3.4074310093890734),
(1185, 45, 43.414120913486684, -3.407421970344154),
(1186, 45, 43.414097462596594, -3.4074005814023662),
(1187, 45, 43.41408635238328, -3.407395638593771),
(1188, 45, 43.414085966815705, -3.4073954659265557),
(1189, 45, 43.41408536918597, -3.407395197705638),
(1190, 45, 43.414080048353526, -3.407392834846993),
(1191, 45, 43.41406432725499, -3.4073914350690804),
(1192, 45, 43.41405838029435, -3.4073909053327682),
(1193, 45, 43.41403673067535, -3.4073984364732173),
(1194, 45, 43.41396438311201, -3.407487318179746),
(1195, 45, 43.41391773446531, -3.4075600823237053),
(1196, 45, 43.413869358308276, -3.4076279631705857),
(1197, 45, 43.41384463923615, -3.407666938184466),
(1198, 45, 43.41382637925901, -3.4076927284638723),
(1199, 45, 43.41374193577047, -3.40782672325234),
(1200, 45, 43.4137365998506, -3.4078367211870386),
(1201, 45, 43.41369137780391, -3.407921450498489),
(1202, 45, 43.413570326351085, -3.4081326392670057),
(1203, 45, 43.413485322951395, -3.4082808899972377),
(1204, 45, 43.413460882996674, -3.408322004911125),
(1205, 45, 43.41345354966915, -3.408334341396948),
(1206, 45, 43.41342045791345, -3.4083900123247513),
(1207, 45, 43.4133485554292, -3.40851097241482),
(1208, 45, 43.413333989356985, -3.408556805502284),
(1209, 45, 43.4133334847664, -3.4085583921966487);

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `rol`
--

CREATE TABLE `rol` (
  `idRol` int(11) NOT NULL,
  `nombre_rol` varchar(20) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

--
-- Volcado de datos para la tabla `rol`
--

INSERT INTO `rol` (`idRol`, `nombre_rol`) VALUES
(1, 'Administrador'),
(2, 'Agricultor'),
(3, 'Piloto');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `trabajo`
--

CREATE TABLE `trabajo` (
  `idTrabajo` int(11) NOT NULL,
  `tipoTarea` varchar(20) NOT NULL,
  `idParcela` int(11) NOT NULL,
  `idPiloto` int(11) NOT NULL,
  `idAgricultor` int(11) NOT NULL,
  `fechaFinalizacion` date NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Volcado de datos para la tabla `trabajo`
--

INSERT INTO `trabajo` (`idTrabajo`, `tipoTarea`, `idParcela`, `idPiloto`, `idAgricultor`, `fechaFinalizacion`) VALUES
(53, 'Abonar', 44, 4, 2, '0000-00-00'),
(54, 'Abonar', 44, 4, 2, '0000-00-00');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `usuario`
--

CREATE TABLE `usuario` (
  `idUsuario` int(11) NOT NULL,
  `nombre` varchar(20) NOT NULL,
  `apellido` varchar(20) NOT NULL,
  `dni` char(9) NOT NULL,
  `contrasena` varchar(20) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

--
-- Volcado de datos para la tabla `usuario`
--

INSERT INTO `usuario` (`idUsuario`, `nombre`, `apellido`, `dni`, `contrasena`) VALUES
(1, 'Administrador', '', '12345678A', 'admin'),
(2, 'Agricultor1', 'Agricultor1', '12312312A', ''),
(3, 'Agricultor2', 'Agricultor2', '12312312B', 'Agricultor2'),
(4, 'Piloto1', '', '', '');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `usuario_rol`
--

CREATE TABLE `usuario_rol` (
  `idUsuario` int(11) NOT NULL,
  `idRol` int(11) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

--
-- Volcado de datos para la tabla `usuario_rol`
--

INSERT INTO `usuario_rol` (`idUsuario`, `idRol`) VALUES
(1, 1),
(2, 2),
(4, 3);

--
-- Índices para tablas volcadas
--

--
-- Indices de la tabla `dron`
--
ALTER TABLE `dron`
  ADD PRIMARY KEY (`idDron`),
  ADD KEY `FK_idPiloto_Dron` (`idPiloto`);

--
-- Indices de la tabla `parcela`
--
ALTER TABLE `parcela`
  ADD PRIMARY KEY (`idParcela`),
  ADD KEY `FK_idAgricultor` (`idAgricultor`);

--
-- Indices de la tabla `punto`
--
ALTER TABLE `punto`
  ADD PRIMARY KEY (`idPunto`),
  ADD KEY `FK_idParcela_Punto` (`idParcela`);

--
-- Indices de la tabla `rol`
--
ALTER TABLE `rol`
  ADD PRIMARY KEY (`idRol`);

--
-- Indices de la tabla `trabajo`
--
ALTER TABLE `trabajo`
  ADD PRIMARY KEY (`idTrabajo`),
  ADD KEY `FK_idPiloto_Trabajo` (`idPiloto`),
  ADD KEY `FK_idParcela_Trabajo2` (`idParcela`),
  ADD KEY `FK_idAgricultor_Trabajo` (`idAgricultor`);

--
-- Indices de la tabla `usuario`
--
ALTER TABLE `usuario`
  ADD PRIMARY KEY (`idUsuario`);

--
-- Indices de la tabla `usuario_rol`
--
ALTER TABLE `usuario_rol`
  ADD PRIMARY KEY (`idUsuario`,`idRol`),
  ADD KEY `FOREING_idRol` (`idRol`);

--
-- AUTO_INCREMENT de las tablas volcadas
--

--
-- AUTO_INCREMENT de la tabla `dron`
--
ALTER TABLE `dron`
  MODIFY `idDron` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=3;

--
-- AUTO_INCREMENT de la tabla `parcela`
--
ALTER TABLE `parcela`
  MODIFY `idParcela` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=46;

--
-- AUTO_INCREMENT de la tabla `punto`
--
ALTER TABLE `punto`
  MODIFY `idPunto` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=1210;

--
-- AUTO_INCREMENT de la tabla `rol`
--
ALTER TABLE `rol`
  MODIFY `idRol` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=4;

--
-- AUTO_INCREMENT de la tabla `trabajo`
--
ALTER TABLE `trabajo`
  MODIFY `idTrabajo` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=55;

--
-- AUTO_INCREMENT de la tabla `usuario`
--
ALTER TABLE `usuario`
  MODIFY `idUsuario` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=5;

--
-- Restricciones para tablas volcadas
--

--
-- Filtros para la tabla `dron`
--
ALTER TABLE `dron`
  ADD CONSTRAINT `FK_idPiloto_Dron` FOREIGN KEY (`idPiloto`) REFERENCES `usuario` (`idUsuario`) ON DELETE CASCADE ON UPDATE CASCADE;

--
-- Filtros para la tabla `parcela`
--
ALTER TABLE `parcela`
  ADD CONSTRAINT `FK_idAgricultor` FOREIGN KEY (`idAgricultor`) REFERENCES `usuario` (`idUsuario`) ON DELETE CASCADE ON UPDATE CASCADE;

--
-- Filtros para la tabla `punto`
--
ALTER TABLE `punto`
  ADD CONSTRAINT `FK_idParcela_Punto` FOREIGN KEY (`idParcela`) REFERENCES `parcela` (`idParcela`) ON DELETE CASCADE ON UPDATE CASCADE;

--
-- Filtros para la tabla `trabajo`
--
ALTER TABLE `trabajo`
  ADD CONSTRAINT `FK_idAgricultor_Trabajo` FOREIGN KEY (`idAgricultor`) REFERENCES `usuario` (`idUsuario`),
  ADD CONSTRAINT `FK_idParcela_Trabajo2` FOREIGN KEY (`idParcela`) REFERENCES `parcela` (`idParcela`) ON DELETE CASCADE ON UPDATE CASCADE,
  ADD CONSTRAINT `FK_idPiloto_Trabajo` FOREIGN KEY (`idPiloto`) REFERENCES `usuario` (`idUsuario`);

--
-- Filtros para la tabla `usuario_rol`
--
ALTER TABLE `usuario_rol`
  ADD CONSTRAINT `FOREING_idRol` FOREIGN KEY (`idRol`) REFERENCES `rol` (`idRol`) ON DELETE CASCADE ON UPDATE CASCADE,
  ADD CONSTRAINT `FOREING_idUsuario` FOREIGN KEY (`idUsuario`) REFERENCES `usuario` (`idUsuario`) ON DELETE CASCADE ON UPDATE CASCADE;
COMMIT;

/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
